/*
 * ComiXed - A digital comic book library management application.
 * Copyright (C) 2020, The ComiXed Project
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses>
 */

package org.comixedproject.scrapers.comicvine.actions;

import static junit.framework.TestCase.*;

import java.io.IOException;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.TimeZone;
import okhttp3.mockwebserver.MockResponse;
import okhttp3.mockwebserver.MockWebServer;
import org.comixedproject.scrapers.ScrapingException;
import org.comixedproject.scrapers.comicvine.model.ComicVinePublisher;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.InjectMocks;
import org.mockito.junit.MockitoJUnitRunner;
import org.springframework.http.HttpHeaders;
import org.springframework.http.MediaType;

@RunWith(MockitoJUnitRunner.class)
public class ComicVineGetPublisherDetailsActionTest {
  private static final String TEST_API_KEY = "this is the api key";
  private static final String TEST_VOLUME_ID = "282568";

  private static final String TEST_BAD_DATA = "This is not JSON";
  private static final String TEST_GOOD_DATA =
      "{\"error\":\"OK\",\"limit\":1,\"offset\":0,\"number_of_page_results\":1,\"number_of_total_results\":1,\"status_code\":1,\"results\":{\"api_detail_url\":\"https:\\/\\/comicvine.gamespot.com\\/api\\/publisher\\/4010-10\\/\",\"description\":\"<h2>Current Personnel<\\/h2><ul><li><a href=\\\"\\/diane-nelson\\/4040-60224\\/\\\" data-ref-id=\\\"4040-60224\\\">Diane Nelson<\\/a>: President<\\/li><li><a href=\\\"\\/jim-lee\\/4040-2399\\/\\\" data-ref-id=\\\"4040-2399\\\">Jim Lee<\\/a> &amp; <a href=\\\"\\/dan-didio\\/4040-51584\\/\\\" data-ref-id=\\\"4040-51584\\\">Dan Didio<\\/a>: Co-Publishers<\\/li><li><a href=\\\"\\/bob-harras\\/4040-40985\\/\\\" data-ref-id=\\\"4040-40985\\\">Bob Harras<\\/a>: Editor-In-Chief<\\/li><li><a href=\\\"\\/geoff-johns\\/4040-40439\\/\\\" data-ref-id=\\\"4040-40439\\\">Geoff Johns<\\/a>: Chief Creative Officer<\\/li><li><a href=\\\"\\/john-rood\\/4040-71914\\/\\\" data-ref-id=\\\"4040-71914\\\">John Rood<\\/a>: Executive Vice President, Sales, Marketing and Business Development<\\/li><\\/ul><h2><strong>History<\\/strong><\\/h2><p>What is known today as DC Comics was founded in 1934 by publishing entrepreneur <a href=\\\"\\/malcolm-wheeler-nicholson\\/4040-43628\\/\\\" data-ref-id=\\\"4040-43628\\\">Malcolm Wheeler-Nicholson<\\/a> under the name of \\\"National Allied Publications\\\". DC was formed by the merging of \\\"National Allied Publications\\\" and \\\"Detective Comics Inc\\\", as well as the affiliated \\\"All-American Publications\\\". Despite being officially known as \\\"National Comics\\\", the comic covers carried a \\\"DC\\\" logo and were referred to as a result of its nickname: \\\"DC Comics\\\". People had nicknamed it \\\"DC\\\" because of one its most popular comic series; <em><a href=\\\"\\/detective-comics\\/4050-18058\\/\\\" data-ref-id=\\\"4050-18058\\\">Detective Comics<\\/a><\\/em> and thus was born one of the world's most recognizable comic book brandings along with rivals <a href=\\\"\\/marvel\\/4010-31\\/\\\" data-ref-id=\\\"4010-31\\\">Marvel<\\/a> publishing.<\\/p><p>The company did not officially change its name to DC Comics however, until 1977 during the presidency of <a href=\\\"\\/jenette-kahn\\/4040-47576\\/\\\" data-ref-id=\\\"4040-47576\\\">Jenette Kahn<\\/a>.<\\/p><p>DC Comics has its current official headquarters at 1700 Broadway, 7th, New York, New York. Random House distributes DC Comics' books to the bookstore market, while Diamond Comics Distributors supplies the comics shop specialty market.<\\/p><h3>Golden Age<\\/h3><figure data-align=\\\"right\\\" data-size=\\\"medium\\\" data-img-src=\\\"https:\\/\\/static.comicvine.com\\/uploads\\/original\\/14\\/148518\\/2969569-dc%20house%20ad%2091412b.jpg\\\" data-ref-id=\\\"1300-2969569\\\" data-ratio=\\\"1.5287474332649\\\" data-width=\\\"974\\\" data-embed-type=\\\"image\\\" style=\\\"width: 974px\\\"><a class=\\\"fluid-height\\\" style=\\\"padding-bottom:152.9%\\\" href=\\\"https:\\/\\/static.comicvine.com\\/uploads\\/original\\/14\\/148518\\/2969569-dc%20house%20ad%2091412b.jpg\\\" data-ref-id=\\\"1300-2969569\\\"><img alt=\\\"No Caption Provided\\\" src=\\\"https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/scale_medium\\/14\\/148518\\/2969569-dc%20house%20ad%2091412b.jpg\\\" srcset=\\\"https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/original\\/14\\/148518\\/2969569-dc%20house%20ad%2091412b.jpg 974w, https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/scale_medium\\/14\\/148518\\/2969569-dc%20house%20ad%2091412b.jpg 627w\\\" sizes=\\\"(max-width: 627px) 100vw, 627px\\\" data-width=\\\"627\\\"><\\/a><\\/figure><p>National Allied Publications' first comic was <a href=\\\"\\/new-fun-1-the-big-comic-magazine\\/4000-110666\\/\\\" data-ref-id=\\\"4000-110666\\\"><i>New Fun: The Big Comic Magazine #1<\\/i><\\/a> which was released in the February of 1935. It hit off, and was surprisingly popular. Later that year, a second title was released: <i><a href=\\\"\\/new-comics-1\\/4000-109779\\/\\\" data-ref-id=\\\"4000-109779\\\">New Comics #1<\\/a>.<\\/i> The size and length <i>New Comics #1<\\/i> became the archetype for many comics afterwards, and it became the longest running comic series of all time.<\\/p><p>In 1938, National launched<a href=\\\"\\/action-comics\\/4050-18005\\/\\\" data-ref-id=\\\"4050-18005\\\"><em> Action Comics<\\/em><\\/a>, which featured the brand new character from regular contributors <a href=\\\"\\/jerry-siegel\\/4040-40754\\/\\\" data-ref-id=\\\"4040-40754\\\">Jerry Siegel<\\/a> and <a href=\\\"\\/joe-shuster\\/4040-40755\\/\\\" data-ref-id=\\\"4040-40755\\\">Joe Shuster<\\/a>, <a href=\\\"\\/\\/www.comicvine.com\\/superman\\/4005-1807\\/\\\" data-ref-id=\\\"4005-1807\\\">Superman<\\/a>. Originally dismissed as \\\"silly\\\" by editorial, reports soon came back noting the popularity and sales increase resulting from the Superman feature. Superman quickly became a sensation and before long, dozens of imitations from both National and other publishing houses appeared almost overnight. Writer <a href=\\\"\\/bill-finger\\/4040-43591\\/\\\" data-ref-id=\\\"4040-43591\\\">Bill Finger<\\/a> and his artist employer <a href=\\\"\\/bob-kane\\/4040-19137\\/\\\" data-ref-id=\\\"4040-19137\\\">Bob Kane<\\/a> soon submitted <a href=\\\"\\/\\/www.comicvine.com\\/batman\\/4005-1699\\/\\\" data-ref-id=\\\"4005-1699\\\">Batman<\\/a> to appear in <a href=\\\"\\/detective-comics\\/4050-18058\\/\\\" data-ref-id=\\\"4050-18058\\\"><em>Detective Comics<\\/em><\\/a> and before long, an entire <a href=\\\"\\/justice-society-of-america\\/4060-27589\\/\\\" data-ref-id=\\\"4060-27589\\\">Justice Society of America<\\/a> had been formed including properties such as <a href=\\\"\\/jay-garrick\\/4005-2395\\/\\\" data-ref-id=\\\"4005-2395\\\">The Flash<\\/a>, <a href=\\\"\\/alan-scott\\/4005-12663\\/\\\" data-ref-id=\\\"4005-12663\\\">Green Lantern<\\/a>, <a href=\\\"\\/wesley-dodds\\/4005-9299\\/\\\" data-ref-id=\\\"4005-9299\\\">The Sandman<\\/a>, <a href=\\\"\\/\\/www.comicvine.com\\/wonder-woman\\/4005-2048\\/\\\" data-ref-id=\\\"4005-2048\\\">Wonder Woman<\\/a>, <a href=\\\"\\/hawkman\\/4005-8337\\/\\\" data-ref-id=\\\"4005-8337\\\">Hawkman<\\/a> and <a href=\\\"\\/spectre\\/4005-2361\\/\\\" data-ref-id=\\\"4005-2361\\\">The Spectre<\\/a>, to name a few, many of whom were either created or written by the prolific <a href=\\\"\\/gardner-fox\\/4040-41171\\/\\\" data-ref-id=\\\"4040-41171\\\">Gardner Fox<\\/a>.<\\/p><p>With the establishment of DC as one of the major comic book companies and with many of the most marketable names in the early years of comics, it is sometimes considered the main company that other companies had to compete with. Companies tried different approaches, One that succeeded and often outsold DC for instance was <a href=\\\"\\/fawcett-publications\\/4010-34\\/\\\" data-ref-id=\\\"4010-34\\\">Fawcett Publications<\\/a> who had a character who some consider similar to <a href=\\\"\\/superman\\/4005-1807\\/\\\" data-ref-id=\\\"4005-1807\\\">Superman<\\/a> who was an all-powerful hero with a supporting \\\"family\\\" known as <a href=\\\"\\/\\/www.comicvine.com\\/billy-batson\\/4005-2350\\/\\\" data-ref-id=\\\"4005-2350\\\">Captain Marvel and the Marvel Family,<\\/a> whereas other companies such as <a href=\\\"\\/charlton\\/4010-125\\/\\\" data-ref-id=\\\"4010-125\\\">Charlton Comics<\\/a> created entire new worlds preventing DC from attacking them with lawsuits. Further along in the <a href=\\\"\\/silver-age-of-comics\\/4015-55821\\/\\\" data-ref-id=\\\"4015-55821\\\">Silver Age<\\/a> many of these companies failed or like Fawcett were sued out of existence. Thus although they had once been competitors, many of the soon public domain properties of Fawcett and Charlton were eventually revived and trademarked and seemingly taken under DC's control.<\\/p><h3>Silver &amp; Bronze Age<\\/h3><p>During the post-War years, the popularity of superheroes had declined almost completely, though DC and other publishers were still going strong moving into other genres such as funny animals, romance, Sci-Fi, Westerns and horror. Major characters such as Batman, Wonder Woman and Superman has managed to remain in publication and by the mid-1950s the superhero was again due for a comeback. <a href=\\\"\\/showcase-4-mystery-of-the-human-thunderbolt-the-ma\\/4000-2653\\/\\\" data-ref-id=\\\"4000-2653\\\"><em>Showcase #4<\\/em><\\/a> in 1956 introduced readers to Barry Allen, the all-new Flash re-imagined with a sleeker design and steeped much heavier in science fiction (an the older Golden Age heroes being relegated to existing on Earth Two). Characters such as The Atom, Green Lantern and the JSA, now reinvented as the Justice League of America soon followed and a new superhero boom was kicked off.<\\/p><p>During this time, The <a href=\\\"\\/comics-code-authority\\/4015-42382\\/\\\" data-ref-id=\\\"4015-42382\\\">Comics Code Authority<\\/a> has also come into play, which drastically subdued the content available in the comic book medium. Many of the stories during the period moved away from more controversial horror or violent themes.<\\/p><p>With the re-invigoration of Marvel in the 1960s under the leadership of <a href=\\\"\\/stan-lee\\/4040-40467\\/\\\" data-ref-id=\\\"4040-40467\\\">Stan Lee<\\/a> and <a href=\\\"\\/jack-kirby\\/4040-5614\\/\\\" data-ref-id=\\\"4040-5614\\\">Jack Kirby<\\/a>, DC found itself a new and more potent competitor. Marvel succeeded by breaking what had become by then generic archetypes of superheroes by introducing characters which were younger and more flawed (and thus appeared more human and appealed to a younger crowd in a more direct manner.) After falling behind Marvel in sales, DC was finally forced to adopt much of the same system which Marvel had, by introducing such young teams as the <a href=\\\"\\/teen-titans\\/4060-19081\\/\\\" data-ref-id=\\\"4060-19081\\\">Teen Titans<\\/a> to compete with the <a href=\\\"\\/x-men\\/4060-3173\\/\\\" data-ref-id=\\\"4060-3173\\\">X-Men<\\/a>.<\\/p><p> <\\/p><h3>Modern Age &amp; Crisis on Infinite Earths<\\/h3><figure data-align=\\\"right\\\" data-size=\\\"medium\\\" data-img-src=\\\"https:\\/\\/static.comicvine.com\\/uploads\\/original\\/14\\/148518\\/2959713-dc%20previews%20poster.jpg\\\" data-ref-id=\\\"1300-2959713\\\" data-ratio=\\\"1.3491436100132\\\" data-width=\\\"759\\\" data-embed-type=\\\"image\\\" style=\\\"width: 759px\\\"><a class=\\\"fluid-height\\\" style=\\\"padding-bottom:134.9%\\\" href=\\\"https:\\/\\/static.comicvine.com\\/uploads\\/original\\/14\\/148518\\/2959713-dc%20previews%20poster.jpg\\\" data-ref-id=\\\"1300-2959713\\\"><img alt=\\\"The Modern Age\\\" src=\\\"https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/scale_medium\\/14\\/148518\\/2959713-dc%20previews%20poster.jpg\\\" srcset=\\\"https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/original\\/14\\/148518\\/2959713-dc%20previews%20poster.jpg 759w, https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/scale_medium\\/14\\/148518\\/2959713-dc%20previews%20poster.jpg 711w\\\" sizes=\\\"(max-width: 711px) 100vw, 711px\\\" data-width=\\\"711\\\"><\\/a><figcaption>The Modern Age<\\/figcaption><\\/figure><p>In 1985, DC Comics decided its 50 years of continuity and numerous alternative Earths had become too messy and was in need of new blank slate. DC penned one of the first major comic book crossovers that incorporated almost every DC title and character ever published by the company. The series ended with multiple Earths being erased and merging into to one unified Earth. Following this, Batman, Superman and Wonder Woman were given new leases of life thanks to big name creators such as John Byrne, Frank Miller and <a href=\\\"\\/george-perez\\/4040-2913\\/\\\" data-ref-id=\\\"4040-2913\\\">George Perez<\\/a> that redefined the elderly heroes for a new generation.<\\/p><p>During this same period, the comic audience has begun to grow up and the direct market for comic stores had opened allowing a wider variety of publications to be experimented with. One such experiment involved bringing in British writer Alan Moore to pen the low selling <em>Saga of the Swamp Thing<\\/em> series. What resulted was style of comic book not experienced before by mainstream readers in its literary and story driven complexity and execution. Before long, other writers from across the pond such as Neil Gaiman, Peter Milligan and Grant Morrison were recruited to revamp obscure properties and tell new and interesting stories with an older audience in mind. 1986 saw the release of two seminal works from DC Comics, Frank Miller's <em>The Dark Knight Returns<\\/em> and Alan Moore's <em>Watchmen<\\/em> that reached unprecedented levels of critical acclaim and outside media attention. By the 90's DC and the entire comic book industry experienced a boom in mature comics aimed at older audiences and simultaneously witnessed a collector's boom that increased sales but almost caused the industry to collapse soon after.<\\/p><p>In 1993, senior editor Karen Berger convinced DC to make her own imprint for mature readers named <a href=\\\"\\/vertigo\\/4010-521\\/\\\" data-ref-id=\\\"4010-521\\\">Vertigo<\\/a>, similar to DC imprints <a href=\\\"\\/piranha-press\\/4010-2083\\/\\\" data-ref-id=\\\"4010-2083\\\">Piranha Press<\\/a> and <a href=\\\"\\/paradox-press\\/4010-1982\\/\\\" data-ref-id=\\\"4010-1982\\\">Paradox Press<\\/a> as well as Marvel's <a href=\\\"\\/epic\\/4010-300\\/\\\" data-ref-id=\\\"4010-300\\\">Epic Comics<\\/a>. Using popular titles such as <a href=\\\"\\/animal-man\\/4050-3976\\/\\\" data-ref-id=\\\"4050-3976\\\"><em>Animal Man<\\/em><\\/a>, <a href=\\\"\\/swamp-thing\\/4050-3465\\/\\\" data-ref-id=\\\"4050-3465\\\"><em>Swamp Thing<\\/em><\\/a>, <a href=\\\"\\/hellblazer\\/4050-4008\\/\\\" data-ref-id=\\\"4050-4008\\\"><em>Hellblazer<\\/em><\\/a>, <a href=\\\"\\/the-sandman\\/4050-4207\\/\\\" data-ref-id=\\\"4050-4207\\\"><em>The Sandman<\\/em><\\/a> and <a href=\\\"\\/shade-the-changing-man\\/4050-4375\\/\\\" data-ref-id=\\\"4050-4375\\\"><em>Shade, The Changing Man<\\/em><\\/a> as its blueprint along side new creator owned material, DC\\/Vertigo became a hub for intelligent and acclaimed comic books. While rival Marvel Comics continued to dominate the publishing arena with their exceedingly popular properties, DC\\/Vertigo became the destination for literary and inventive titles during the period.<\\/p><p>In 1999, DC purchased Jim Lee's <a href=\\\"\\/wildstorm\\/4010-708\\/\\\" data-ref-id=\\\"4010-708\\\">WildStorm Productions<\\/a>, formerly one of the founding studios of <a href=\\\"\\/image\\/4010-513\\/\\\" data-ref-id=\\\"4010-513\\\">Image<\\/a>. The line of WildStorm comics and properties came under DC's control though the line continued to be published on the West Coast away from DC editorial until 2010.<\\/p><h3>All Star DC Comics<\\/h3><p>In 2000 Marvel Comics started an imprint called ultimate marvel in which the characters' origin is changed and modernized. This eventually led DC to starting an imprint of their own in 2005, thus All Star was born.<\\/p><p>Both All-Star series are in their own continuity, except <em>All-Star Batman and Robin<\\/em> which was part of <a href=\\\"\\/\\/www.comicvine.com\\/earth-31\\/4020-57575\\/\\\" data-ref-id=\\\"4020-57575\\\">Earth- 31<\\/a>.<\\/p><p><strong>All Star Batman and Robin the Boy Wonder<\\/strong><\\/p><p><em>All-Star Batman<\\/em> started in 2005 and was written by Frank Miller and Penciled by Jim Lee. This was the first series in the All Star imprint and opened to mainly negative reviews but had high sales. The series was released in a sporadic schedule. The series only reached 10 issues (2008) 2 issues before the intended end of the series.<\\/p><p><strong>All Star Superman<\\/strong><\\/p><p><em>All-Star Superman<\\/em> started in 2006 and was written by Grant Morrison and Penciled by Frank Quitley. This was the second series under the All Star imprint, the first being <em>All-Star Batman and Robin<\\/em>. The series opened to mainly good reviews and went on to win the Eisner Award for best new series in 2006 and best ongoing series in 2007 and 2009. Like <em>All-Star Batman<\\/em> the series was also released in a sporadic schedule. The series ended with issue 12. The series overall has widely considered to be one of the best Superman stories of all time.<\\/p><h4> <\\/h4><h3>The New 52<\\/h3><figure data-align=\\\"right\\\" data-img-src=\\\"https:\\/\\/static.comicvine.com\\/uploads\\/original\\/5\\/58664\\/1837076-dc_comics_reinvents_pg564mg_x_large.jpg\\\" data-ref-id=\\\"1300-1837076\\\" data-size=\\\"small\\\" data-ratio=\\\"0.73469387755102\\\" data-width=\\\"490\\\" data-embed-type=\\\"image\\\" style=\\\"width: 490px\\\"><a class=\\\"fluid-height\\\" style=\\\"padding-bottom:73.5%\\\" href=\\\"https:\\/\\/static.comicvine.com\\/uploads\\/original\\/5\\/58664\\/1837076-dc_comics_reinvents_pg564mg_x_large.jpg\\\" data-ref-id=\\\"1300-1837076\\\"><img alt=\\\"Justice League # 1\\\" src=\\\"data:image\\/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\\\" sizes=\\\"(max-width: 320px) 100vw, 320px\\\" data-width=\\\"320\\\" class=\\\"js-lazy-load-image\\\" data-src=\\\"https:\\/\\/comicvine1.cbsistatic.com\\/bundles\\/phoenixsite\\/images\\/core\\/loose\\/img_broken.png\\\" data-srcset=\\\"https:\\/\\/comicvine1.cbsistatic.com\\/bundles\\/phoenixsite\\/images\\/core\\/loose\\/img_broken.png 490w, https:\\/\\/comicvine1.cbsistatic.com\\/bundles\\/phoenixsite\\/images\\/core\\/loose\\/img_broken.png 480w, https:\\/\\/comicvine1.cbsistatic.com\\/bundles\\/phoenixsite\\/images\\/core\\/loose\\/img_broken.png 320w\\\"><noscript><img alt=\\\"Justice League # 1\\\" src=\\\"https:\\/\\/comicvine1.cbsistatic.com\\/bundles\\/phoenixsite\\/images\\/core\\/loose\\/img_broken.png\\\" srcset=\\\"https:\\/\\/comicvine1.cbsistatic.com\\/bundles\\/phoenixsite\\/images\\/core\\/loose\\/img_broken.png 490w, https:\\/\\/comicvine1.cbsistatic.com\\/bundles\\/phoenixsite\\/images\\/core\\/loose\\/img_broken.png 480w, https:\\/\\/comicvine1.cbsistatic.com\\/bundles\\/phoenixsite\\/images\\/core\\/loose\\/img_broken.png 320w\\\" sizes=\\\"(max-width: 320px) 100vw, 320px\\\" data-width=\\\"320\\\"><\\/noscript><\\/a><figcaption>Justice League # 1<\\/figcaption><\\/figure><p>In 2011, after a period of declining comic sales, DC announced they were cancelling all the main titles and starting over with all <a href=\\\"\\/the-new-52\\/4015-56061\\/\\\" data-ref-id=\\\"4015-56061\\\">New 52's<\\/a> as part of a relaunch. In charge of the relaunch is <a href=\\\"\\/geoff-johns\\/4040-40439\\/\\\" data-ref-id=\\\"4040-40439\\\">Geoff Johns<\\/a> and <a href=\\\"\\/jim-lee\\/4040-2399\\/\\\" data-ref-id=\\\"4040-2399\\\">Jim Lee<\\/a>. The relaunch started with the release of <a href=\\\"\\/justice-league-justice-league-part-one\\/4000-290431\\/\\\" data-ref-id=\\\"4000-290431\\\"><em>Justice League<\\/em> # 1<\\/a> on August 31st. this was done partially to revitalize the company and to de-age the characters and thus make them more dynamic. On January 12, 2012, it was announced that there would be a second wave of the new 52 where six titles would be getting canceled with another six to replace them, though the plan to stay at 52 ongoing monthlies seems to be consistent. DC also released a Third wave in September 2012, one year after the relaunch in September 2011. One book in the Third Wave, <em>Talon<\\/em>, starring Calvin Rose was the first solo book for a character who was introduced in the New 52. The Fourth wave started in January 2013 and ended in March 2013, meaning that it was the first wave not to come out in a single month. The Fifth Wave consisted of titles such as <em>the Movement<\\/em>, <em>the Green Team<\\/em> and <em>Superman Unchained<\\/em>.<\\/p><p>The New 52 had proved to be so successful with critics, fans and commercially that Marvel the main competitor of DC decided to do a relaunch of their own called \\\"<a href=\\\"\\/\\/www.comicvine.com\\/marvel-now\\/4015-56129\\/\\\" data-ref-id=\\\"4015-56129\\\">Marvel NOW!<\\/a>\\\" in late 2012.<\\/p><h2><strong>Relocating from Manhattan to Burbank<\\/strong><\\/h2><p>In 2015, DC Entertainment moved their entire operations from their Manhattan headquarters in New York City to their new home in Burbank, California. DC's digital and administrative departments had already been relocated to Burbank beginning in 2010. The new office is only a few blocks from their corporate parent company, Warner Bros. Studios.<\\/p><h2><b>DC Imprints and Sub-Imprints<\\/b><\\/h2><p><strong>Active<\\/strong><\\/p><ul><li><a href=\\\"\\/vertigo\\/4010-521\\/\\\" data-ref-id=\\\"4010-521\\\">Vertigo<\\/a> (1993-)<\\/li><li><a href=\\\"\\/mad\\/4050-9318\\/\\\" data-ref-id=\\\"4050-9318\\\">MAD\\/ MAD Magazine<\\/a> (Acquired by Warner in the 60's, integrated with DC Comics around 2001.)<\\/li><\\/ul><p><strong>Defunct<\\/strong><\\/p><ul><li><a href=\\\"\\/wildstorm\\/4010-708\\/\\\" data-ref-id=\\\"4010-708\\\">WildStorm<\\/a> (1999-2010)* <ul><li><a href=\\\"\\/cmx\\/4010-2345\\/\\\" data-ref-id=\\\"4010-2345\\\">CMX<\\/a> (2004-2010)<\\/li><li><a href=\\\"\\/\\/www.comicvine.com\\/homage-comics\\/4010-2084\\/\\\" data-ref-id=\\\"4010-2084\\\">Homage Comics<\\/a><\\/li><li><a href=\\\"\\/cliffhanger\\/4010-2287\\/\\\" data-ref-id=\\\"4010-2287\\\">Cliffhanger<\\/a><\\/li><li><a href=\\\"\\/americas-best-comics\\/4010-731\\/\\\" data-ref-id=\\\"4010-731\\\">America's Best Comics<\\/a> (1999-2010)<\\/li><\\/ul><\\/li><li><a href=\\\"\\/helix\\/4010-602\\/\\\" data-ref-id=\\\"4010-602\\\">Helix<\\/a> (1996-1998)<\\/li><li><a href=\\\"\\/tangent-comics\\/4010-638\\/\\\" data-ref-id=\\\"4010-638\\\">Tangent Comics<\\/a> (1997-2008)<\\/li><li><a href=\\\"\\/paradox-press\\/4010-1982\\/\\\" data-ref-id=\\\"4010-1982\\\">Paradox Press<\\/a> (1993-2001)<\\/li><li><a href=\\\"\\/piranha-press\\/4010-2083\\/\\\" data-ref-id=\\\"4010-2083\\\">Piranha Press<\\/a> (1989-1994)<\\/li><li><a href=\\\"\\/humanoids\\/4010-1346\\/\\\" data-ref-id=\\\"4010-1346\\\">Humanoids<\\/a> (2004)<\\/li><li><a href=\\\"\\/2000ad\\/4010-2358\\/\\\" data-ref-id=\\\"4010-2358\\\">2000AD<\\/a> (Reprints from Rebellion's <em>2000 AD<\\/em> line)<\\/li><li><a href=\\\"\\/milestone\\/4010-538\\/\\\" data-ref-id=\\\"4010-538\\\">Milestone<\\/a> (Owned by Milestone Media)<\\/li><li><a href=\\\"\\/impact\\/4010-483\\/\\\" data-ref-id=\\\"4010-483\\\">Impact!<\\/a><\\/li><li><a href=\\\"\\/focus\\/4010-1245\\/\\\" data-ref-id=\\\"4010-1245\\\">Focus<\\/a><\\/li><li><a href=\\\"\\/minx\\/4010-2227\\/\\\" data-ref-id=\\\"4010-2227\\\">Minx<\\/a> (2007-2008)<\\/li><li><a href=\\\"\\/zuda-comics\\/4010-2069\\/\\\" data-ref-id=\\\"4010-2069\\\">Zuda<\\/a> (2007-2010)<\\/li><\\/ul><p>*the imprint was founded in 1992 but as part of the <a href=\\\"\\/image\\/4010-513\\/\\\" data-ref-id=\\\"4010-513\\\">Image<\\/a> conglomerate and only moved to DC in 1999.<\\/p><h2>Other Media<\\/h2><h4><strong>Film<\\/strong><\\/h4><p>DC Comics' parent company <a href=\\\"\\/warner-brothers\\/4010-574\\/\\\" data-ref-id=\\\"4010-574\\\">Warner Brothers<\\/a> (with a few exceptions) has produced a variety of feature films based on DC Comics properties for cinematic release.<\\/p><ul><li><em><a href=\\\"\\/superman-and-the-mole-men\\/4025-638\\/\\\" data-ref-id=\\\"4025-638\\\">Superman and the Mole-Men<\\/a><\\/em> (November 23, 1951)<\\/li><li><em><a href=\\\"\\/batman-the-movie\\/4025-55\\/\\\" data-ref-id=\\\"4025-55\\\">Batman: The Movie<\\/a><\\/em> (July 30, 1966)<\\/li><li><em><a href=\\\"\\/superman\\/4025-2\\/\\\" data-ref-id=\\\"4025-2\\\">Superman<\\/a><\\/em> (December 15, 1978)<\\/li><li><em><a href=\\\"\\/superman-ii\\/4025-5\\/\\\" data-ref-id=\\\"4025-5\\\">Superman II<\\/a> <\\/em>(June 19, 1981)<\\/li><li><em><a href=\\\"\\/\\/www.comicvine.com\\/swamp-thing\\/4005-15809\\/\\\" data-ref-id=\\\"4005-15809\\\">Swamp Thing<\\/a><\\/em> (February 18, 1982)<\\/li><li><em><a href=\\\"\\/superman-iii\\/4025-6\\/\\\" data-ref-id=\\\"4025-6\\\">Superman III<\\/a> <\\/em>(June 17, 1983)<\\/li><li><em><a href=\\\"\\/supergirl\\/4025-171\\/\\\" data-ref-id=\\\"4025-171\\\">Supergirl<\\/a> <\\/em>(November 21, 1984)<\\/li><li><em><a href=\\\"\\/superman-iv-the-quest-for-peace\\/4025-9\\/\\\" data-ref-id=\\\"4025-9\\\">Superman IV: The Quest For Peace<\\/a><\\/em> (July 24, 1987)<\\/li><li><em><a href=\\\"\\/the-return-of-swamp-thing\\/4025-176\\/\\\" data-ref-id=\\\"4025-176\\\">Return of Swamp Thing<\\/a><\\/em> (May 12, 1989)<\\/li><li><em><a href=\\\"\\/batman\\/4025-4\\/\\\" data-ref-id=\\\"4025-4\\\">Batman<\\/a><\\/em> (June 23, 1989)<\\/li><li><em><a href=\\\"\\/batman-returns\\/4025-7\\/\\\" data-ref-id=\\\"4025-7\\\">Batman Returns<\\/a><\\/em> (June 19, 1992)<\\/li><li><em><a href=\\\"\\/\\/www.comicvine.com\\/batman-mask-of-the-phantasm\\/4025-82\\/\\\" data-ref-id=\\\"4025-82\\\">Batman: Mask of the Phantasm<\\/a><\\/em> (December 25, 1993)<\\/li><li><em><a href=\\\"\\/batman-forever\\/4025-8\\/\\\" data-ref-id=\\\"4025-8\\\">Batman Forever<\\/a> <\\/em>(June 16, 1995)<\\/li><li><em><a href=\\\"\\/batman-robin\\/4025-10\\/\\\" data-ref-id=\\\"4025-10\\\">Batman &amp; Robin<\\/a> <\\/em>(June 20, 1997)<\\/li><li><em><a href=\\\"\\/steel\\/4025-170\\/\\\" data-ref-id=\\\"4025-170\\\">Steel<\\/a><\\/em> (August 15, 1997)<\\/li><li><em><a href=\\\"\\/catwoman\\/4025-46\\/\\\" data-ref-id=\\\"4025-46\\\">Catwoman<\\/a><\\/em> (July 23, 2004)<\\/li><li><em><a href=\\\"\\/\\/www.comicvine.com\\/constantine\\/4025-26\\/\\\" data-ref-id=\\\"4025-26\\\">Constantine<\\/a><\\/em> (February 18, 2005)<\\/li><li><em><a href=\\\"\\/batman-begins\\/4025-12\\/\\\" data-ref-id=\\\"4025-12\\\">Batman Begins<\\/a><\\/em> (June 14, 2005)<\\/li><li><em><a href=\\\"\\/superman-returns\\/4025-11\\/\\\" data-ref-id=\\\"4025-11\\\">Superman Returns<\\/a><\\/em> (June 28, 2006)<\\/li><li><em><a href=\\\"\\/the-dark-knight\\/4025-15\\/\\\" data-ref-id=\\\"4025-15\\\">The Dark Knight<\\/a> <\\/em>(July 18, 2008)<\\/li><li><em><a href=\\\"\\/watchmen\\/4025-1\\/\\\" data-ref-id=\\\"4025-1\\\">Watchmen<\\/a><\\/em> (March 19, 2009)<\\/li><li><em><a href=\\\"\\/the-losers\\/4025-937\\/\\\" data-ref-id=\\\"4025-937\\\">The Losers<\\/a><\\/em> (April 23, 2010)<\\/li><li><em><a href=\\\"\\/jonah-hex\\/4025-940\\/\\\" data-ref-id=\\\"4025-940\\\">Jonah Hex<\\/a><\\/em> (June 18, 2010)<\\/li><li><em><a href=\\\"\\/green-lantern\\/4025-926\\/\\\" data-ref-id=\\\"4025-926\\\">Green Lantern<\\/a><\\/em> (June 17, 2011)<\\/li><li><em><a href=\\\"\\/the-dark-knight-rises\\/4025-1214\\/\\\" data-ref-id=\\\"4025-1214\\\">The Dark Knight Rises<\\/a><\\/em> (July 20, 2012)<\\/li><li><em><a href=\\\"\\/man-of-steel\\/4025-1375\\/\\\" data-ref-id=\\\"4025-1375\\\">Man of Steel<\\/a> <\\/em>(June 14, 2013)<\\/li><li><em><a href=\\\"https:\\/\\/comicvine.gamespot.com\\/batman-v-superman-dawn-of-justice\\/4025-1981\\/\\\">Batman v Superman: Dawn of Justice <\\/a><\\/em>(March 25, 2016)<\\/li><li><a href=\\\"https:\\/\\/comicvine.gamespot.com\\/suicide-squad\\/4025-2136\\/\\\" data-ref-id=\\\"4025-2136\\\"><em>Suicide Squad<\\/em><\\/a> (August 5, 2016)<\\/li><li><a href=\\\"\\/the-lego-batman-movie\\/4025-2249\\/\\\" data-ref-id=\\\"4025-2249\\\">The LEGO Batman Movie<\\/a> (February 10, 2017)<\\/li><li><a href=\\\"https:\\/\\/comicvine.gamespot.com\\/wonder-woman\\/4025-2234\\/\\\" data-ref-id=\\\"4025-2234\\\">Wonder Woman<\\/a> (June 2, 2017)<\\/li><li><a href=\\\"\\/justice-league\\/4025-1655\\/\\\" data-ref-id=\\\"4025-1655\\\">Justice League<\\/a> (November 17, 2017)<\\/li><\\/ul><h4>Currently in production:<\\/h4><ul><li>Teen Titans Go! To the Movies (Post-Production)<\\/li><li>Aquaman (Post-Production)<\\/li><li>Shazam (Pre-Production)<\\/li><li>Wonder Woman 2 (Pre-Production)<\\/li><li>Suicide Squad 2 (Pre-Production)<\\/li><\\/ul><h4>In development:<\\/h4><ul><li>The Batman<\\/li><li>Man of Steel 2<\\/li><li>Flashpoint<\\/li><li>Cyborg<\\/li><li>Green Lantern Corps <\\/li><li>Justice League Dark<\\/li><li>Batgirl<\\/li><li>Nightwing<\\/li><li>Gotham City Sirens<\\/li><li>Deathstroke<\\/li><li>Black Adam<\\/li><li>Booster Gold<\\/li><\\/ul><p>Other live action films based on publications from DC Comics include <em><a href=\\\"https:\\/\\/comicvine.gamespot.com\\/red\\/4025-980\\/\\\" data-ref-id=\\\"4025-980\\\">RED<\\/a>, <a href=\\\"https:\\/\\/comicvine.gamespot.com\\/red-2\\/4025-1914\\/\\\" data-ref-id=\\\"4025-1914\\\">RED 2<\\/a>, <a href=\\\"https:\\/\\/comicvine.gamespot.com\\/v-for-vendetta\\/4025-13\\/\\\" data-ref-id=\\\"4025-13\\\">V for Vendetta<\\/a>, <a href=\\\"https:\\/\\/comicvine.gamespot.com\\/road-to-perdition\\/4025-31\\/\\\" data-ref-id=\\\"4025-31\\\">Road to Perdition<\\/a><\\/em> and <a href=\\\"https:\\/\\/comicvine.gamespot.com\\/a-history-of-violence\\/4025-21\\/\\\" data-ref-id=\\\"4025-21\\\"><em>A History of Violence<\\/em><\\/a>.<\\/p>\",\"id\":10,\"image\":{\"icon_url\":\"https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/square_avatar\\/0\\/40\\/5213245-dc_logo_blue_final.jpg\",\"medium_url\":\"https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/scale_medium\\/0\\/40\\/5213245-dc_logo_blue_final.jpg\",\"screen_url\":\"https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/screen_medium\\/0\\/40\\/5213245-dc_logo_blue_final.jpg\",\"screen_large_url\":\"https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/screen_kubrick\\/0\\/40\\/5213245-dc_logo_blue_final.jpg\",\"small_url\":\"https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/scale_small\\/0\\/40\\/5213245-dc_logo_blue_final.jpg\",\"super_url\":\"https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/scale_large\\/0\\/40\\/5213245-dc_logo_blue_final.jpg\",\"thumb_url\":\"https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/scale_avatar\\/0\\/40\\/5213245-dc_logo_blue_final.jpg\",\"tiny_url\":\"https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/square_mini\\/0\\/40\\/5213245-dc_logo_blue_final.jpg\",\"original_url\":\"https:\\/\\/comicvine1.cbsistatic.com\\/uploads\\/original\\/0\\/40\\/5213245-dc_logo_blue_final.jpg\",\"image_tags\":\"All Images,DC Comics logo\"},\"name\":\"DC Comics\"},\"version\":\"1.0\"}";
  private static final String TEST_PUBLISHER_NAME = "DC Comics";
  private static final Integer TEST_PUBLISHER_ID = 10;
  private static final String TEST_PUBLISHER_DETAIL_URL =
      "https://comicvine.gamespot.com/api/publisher/4010-10/";
  private static final String TEST_IMAGE_URL =
      "https://comicvine1.cbsistatic.com/uploads/screen_medium/0/40/5213245-dc_logo_blue_final.jpg";

  @InjectMocks private ComicVineGetPublisherDetailsAction getPublisherDetailsAction;

  private MockWebServer comicVineServer;
  private Date coverDate;

  @Before
  public void setUp() throws IOException {
    comicVineServer = new MockWebServer();
    comicVineServer.start();

    final Calendar date = new GregorianCalendar();
    date.setTimeZone(TimeZone.getTimeZone("UTC"));
    date.set(2011, 10 - 1, 31, 0, 0, 0);
    coverDate = date.getTime();

    final String hostname = String.format("http://localhost:%s", this.comicVineServer.getPort());
    getPublisherDetailsAction.setApiUrl(hostname);
    getPublisherDetailsAction.setApiKey(TEST_API_KEY);
  }

  @After
  public void tearDown() throws IOException {
    comicVineServer.shutdown();
  }

  @Test(expected = ScrapingException.class)
  public void testExecuteMissingApiKey() throws ScrapingException {
    getPublisherDetailsAction.setApiKey("");
    getPublisherDetailsAction.execute();
  }

  @Test(expected = ScrapingException.class)
  public void testExecuteMissingApiUrl() throws ScrapingException {
    getPublisherDetailsAction.setApiUrl("");
    getPublisherDetailsAction.execute();
  }

  @Test(expected = ScrapingException.class)
  public void testExecuteBadData() throws ScrapingException {
    this.comicVineServer.enqueue(
        new MockResponse()
            .setBody(TEST_BAD_DATA)
            .addHeader(HttpHeaders.CONTENT_TYPE, MediaType.APPLICATION_JSON_VALUE));
    getPublisherDetailsAction.execute();
  }

  @Test
  public void testExecute() throws ScrapingException {
    this.comicVineServer.enqueue(
        new MockResponse()
            .setBody(TEST_GOOD_DATA)
            .addHeader(HttpHeaders.CONTENT_TYPE, MediaType.APPLICATION_JSON_VALUE));

    final ComicVinePublisher result = getPublisherDetailsAction.execute();

    assertNotNull(result);
    assertEquals(TEST_PUBLISHER_NAME, result.getName());
    assertEquals(TEST_PUBLISHER_ID, result.getId());
    assertEquals(TEST_PUBLISHER_DETAIL_URL, result.getDetailUrl());
    assertFalse(result.getDescription().isEmpty());
    assertEquals(TEST_IMAGE_URL, result.getImage().getScreenUrl());
  }
}
