<mat-toolbar id="app-navigation-bar" color="primary">
  <button
    id="toggle-sidebar-button"
    mat-icon-button
    [matTooltip]="'menu.tooltip.toggle-sidenav' | translate"
    (click)="onToggleSidebar()"
  >
    <mat-icon>menu</mat-icon>
  </button>

  <span id="cx-logo">ComiXed</span>

  @if (isAdmin && !!latestRelease && latestRelease.newer) {
  <button
    id="view-latest-release-button"
    mat-icon-button
    [matTooltip]="
      'menu.tooltip.new-release-available'
        | translate
          : {
              version: latestRelease.version,
              released: latestRelease.updated | date : 'mediumDate'
            }
    "
    [disabled]="checkingLatestVersion"
    (click)="onViewLatestRelease()"
  >
    <mat-icon>new_releases</mat-icon>
  </button>
  }

  <div class="cx-spacer"></div>

  @if (!!user) {
  <button
    class="cx-toolbar-button cx-padding-5"
    mat-icon-button
    [matTooltip]="'navigation.tooltip.account' | translate"
    (click)="onToggleAccountBar()"
  >
    <img loading="lazy" ngxGravatar [alt]="user.email" [email]="user.email" />
  </button>
  } &nbsp; @if (!!user) {
  <a
    class="cx-toolbar-link cx-padding-right-5"
    routerLinkActive="cx-toolbar-link-active"
    (click)="onToggleAccountBar()"
  >
    {{ user.email }}
  </a>
  }

  <button
    id="wiki-page-button"
    class="cx-toolbar-button"
    mat-icon-button
    [matTooltip]="'navigation.tooltip.wiki' | translate"
    (click)="openWikiPage()"
  >
    <mat-icon>help_center</mat-icon>
  </button>

  <button
    id="issue-page-button"
    class="cx-toolbar-button"
    mat-icon-button
    [matTooltip]="'navigation.tooltip.bug-report' | translate"
    (click)="openBugReport()"
  >
    <mat-icon>bug_report</mat-icon>
  </button>

  <button
    id="dark-mode-toggle-button"
    class="cx-toolbar-button"
    mat-icon-button
    [matTooltip]="'navigation.tooltip.dark-mode' | translate"
    (click)="onToggleDarkMode(!darkMode)"
  >
    @if (!darkMode) {
    <mat-icon>light_mode</mat-icon>
    } @if (darkMode) {
    <mat-icon>dark_mode</mat-icon>
    }
  </button>

  <button
    id="toolbar-menu-trigger-button"
    mat-icon-button
    [mat-menu-trigger-for]="mainMenu"
  >
    <mat-icon>more_vert</mat-icon>
  </button>
</mat-toolbar>

<mat-menu #mainMenu="matMenu">
  @if (!user) {
  <button mat-menu-item (click)="onLogin()">
    <mat-icon>login</mat-icon>
    <mat-label>{{ "button.login" | translate }}</mat-label>
  </button>
  } @if (!!user) {
  <mat-divider></mat-divider>
  }
  <button mat-menu-item (click)="openWikiPage()">
    <mat-icon>help_center</mat-icon>
    <mat-label>{{ "menu.help" | translate }}</mat-label>
  </button>
  @if (!!user) {
  <mat-divider></mat-divider>
  } @if (!!user) {
  <button mat-menu-item (click)="onLogout()">
    <mat-icon>logout</mat-icon>
    <mat-label>{{ "button.logout" | translate }}</mat-label>
  </button>
  }
</mat-menu>

<mat-menu #userMenu="matMenu">
  <button mat-menu-item [matMenuTriggerFor]="languageMenu">
    <mat-icon>language</mat-icon>
    <mat-label>{{ "menu.language-menu.root" | translate }}</mat-label>
  </button>
  <button mat-menu-item [matMenuTriggerFor]="loggingMenu">
    <mat-icon>settings</mat-icon>
    <mat-label>{{ "menu.logging-menu.root" | translate }}</mat-label>
  </button>
</mat-menu>

<mat-menu #languageMenu="matMenu">
  @for (option of languages; track option) {
  <button mat-menu-item (click)="onSelectLanguage(option.value)">
    @if (currentLanguage === option.value) {
    <mat-icon>check_box</mat-icon>
    } @if (currentLanguage !== option.value) {
    <mat-icon>check_box_outline_blank</mat-icon>
    }
    <mat-label>{{ option.label }}</mat-label>
  </button>
  }
</mat-menu>

<mat-menu #loggingMenu="matMenu">
  @for (option of loggingOptions; track option) {
  <button mat-menu-item (click)="onSetLogging(option)">
    @if (isCurrentLoggingLevel(option)) {
    <mat-icon>radio_button_checked</mat-icon>
    } @if (!isCurrentLoggingLevel(option)) {
    <mat-icon>radio_button_unchecked</mat-icon>
    }
    <mat-label>{{ "menu.logging-menu." + option | translate }}</mat-label>
  </button>
  }
</mat-menu>
